<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.81.0" />
    <meta name="description" content="">


    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>5. Demo Project :: App Development</title>

    
    <link href="../../css/nucleus.css?1646044682" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1646044682" rel="stylesheet">
    <link href="../../css/hybrid.css?1646044682" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1646044682" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1646044682" rel="stylesheet">
    <link href="../../css/auto-complete.css?1646044682" rel="stylesheet">
    <link href="../../css/theme.css?1646044682" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1646044682" rel="stylesheet">
    
    <link href="../../css/theme-kul.css?1646044682" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1646044682"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    <script src=../../js/devselector.js></script>
<link href="../../css/devselector.css" rel="stylesheet">

  </head>
  <body class="" data-url="../../extra/demo/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
	<img src="../../img/style/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
	<img src="../../img/style/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1646044682"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1646044682"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/appdev-course\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1646044682"></script>

    
  </div>

    <div class="highlightable">
    <h3><a href="../../">Course Contents</a></h3>
    <ul class="topics">
        
          
          




 
  
    
    <li data-nav-id="/android/" title="1. Android Essentials" class="dd-item 
        
        
        
        ">
      <a href="../../android/">
          1. Android Essentials
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/android/activities/" title="1. Life Cycle - Activities" class="dd-item ">
        <a href="../../android/activities/">
        1. Life Cycle - Activities
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/android/intents/" title="2. Messaging - Intents" class="dd-item ">
        <a href="../../android/intents/">
        2. Messaging - Intents
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/android/fragments/" title="3. Complex layouts: Fragments" class="dd-item ">
        <a href="../../android/fragments/">
        3. Complex layouts: Fragments
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/android/views/" title="4. Complex layouts: Nested Views" class="dd-item ">
        <a href="../../android/views/">
        4. Complex layouts: Nested Views
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/android/data-storage/" title="5. Data Storage: File/Network" class="dd-item ">
        <a href="../../android/data-storage/">
        5. Data Storage: File/Network
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/android/signals/" title="6. Embedded Signals" class="dd-item ">
        <a href="../../android/signals/">
        6. Embedded Signals
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/android/security/" title="7. Security By Design" class="dd-item ">
        <a href="../../android/security/">
        7. Security By Design
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/lang/" title="2. Language &amp; Support Tools" class="dd-item 
        
        
        
        ">
      <a href="../../lang/">
          2. Language &amp; Support Tools
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/lang/kotlin/" title="1. Kotlin programming: Essentials" class="dd-item ">
        <a href="../../lang/kotlin/">
        1. Kotlin programming: Essentials
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/lang/kotlin-advanced/" title="2. Kotlin programming: Advanced" class="dd-item ">
        <a href="../../lang/kotlin-advanced/">
        2. Kotlin programming: Advanced
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/lang/kotlin-examples/" title="3. Kotlin Examples/Exercises" class="dd-item ">
        <a href="../../lang/kotlin-examples/">
        3. Kotlin Examples/Exercises
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/lang/tdd/" title="4. Test Driven Development" class="dd-item ">
        <a href="../../lang/tdd/">
        4. Test Driven Development
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/lang/multiplatform/" title="5. Multiplatform Mobile dev." class="dd-item ">
        <a href="../../lang/multiplatform/">
        5. Multiplatform Mobile dev.
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/extra/" title="3. Extra info" class="dd-item 
        parent
        
        
        ">
      <a href="../../extra/">
          3. Extra info
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/extra/install/" title="1. Installation Guide" class="dd-item ">
        <a href="../../extra/install/">
        1. Installation Guide
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/faq/" title="2. Common Errors FAQ" class="dd-item ">
        <a href="../../extra/faq/">
        2. Common Errors FAQ
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/links/" title="3. Links and Tutorials" class="dd-item ">
        <a href="../../extra/links/">
        3. Links and Tutorials
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/project/" title="4. Project Information" class="dd-item ">
        <a href="../../extra/project/">
        4. Project Information
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/demo/" title="5. Demo Project" class="dd-item active">
        <a href="../../extra/demo/">
        5. Demo Project
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://uhintra03.uhasselt.be/studiegidswww/opleidingsonderdeel.aspx?a=2021&amp;i=3291&amp;n=4&amp;t=01"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://toledo.kuleuven.be/portal/"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/kuleuven-diepenbeek/appdev-course/"><i class='fab fa-github'></i> Course Git Repository</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>Course Contents</a> > <a href='../../extra/'>3. Extra info</a> > 5. Demo Project
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#_how-long-to-beat_"><em>How Long To Beat</em></a>
      <ul>
        <li><a href="#what-does-it-do">What does it do?</a></li>
        <li><a href="#how-does-it-work">How does it work?</a></li>
      </ul>
    </li>
    <li><a href="#inspecting-the-source-code">Inspecting the source code</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              5. Demo Project
            </h1>
          

        


<h2 id="_how-long-to-beat_"><em>How Long To Beat</em></h2>
<p>The demo project, residing in the <a href="https://github.com/KULeuven-Diepenbeek/appdev-course/tree/main/examples/kotlin/howlongtobeat">examples/kkotlin/howlongtobeat</a> directory in the source repository, incorporates everything this course has to offer, to give you a taste of what is possible to create within a limited time frame using your newly acquired knowledge. It contains:</p>
<ul>
<li>One main activity, <code>MainActivity</code>, controlling the navigation drawer</li>
<li>Many segments controlled by a navigation system, including two <code>RecyclerView</code> lists.</li>
<li>Permissions for internet and the camera, and an intent system to share information.</li>
<li>Data storage through SQLite and Room, plus private file storage for images.</li>
<li>Multiple HTTPS API calls to demonstrate the retrieval and processing of data.</li>
</ul>
<h3 id="what-does-it-do">What does it do?</h3>
<p>A (moving) picture says more than a thousand words:</p>
<div class="video-mask">
	<video controls preload="metadata">
	  <source src="../../vid/hltb.mp4#t=0.5" type="video/mp4">
	  Your browser does not support HTML video. Here's a link to the MP4-encoded video instead: <a href="../../vid/hltb.mp4">/vid/hltb.mp4</a>.
	</video>
</div>
<p>In case that still wasn&rsquo;t clear, it:</p>
<ol>
<li>&hellip; recognizes Game Boy and Game Boy Color cartridges based on a snapshot you take from your retro games.</li>
<li>&hellip; downloads art data and checks on <a href="https://howlongtobeat.com">howlongtobeat.com</a> how long it takes for an average player to beat the game.</li>
<li>&hellip; saves this information in your personal game database if selected.</li>
<li>&hellip; shows some basic statistics on your game completion progress.</li>
</ol>
<h3 id="how-does-it-work">How does it work?</h3>
<p>The cartridge recognition system (logic in <code>GameFinder.kt</code>) is programmed to adhere to the following logic flow:</p>
<script defer src="../../mermaid/mermaid.min.js">
	mermaid.initialize({
		startOnLoad: true,
		flowchart: {
			useMaxWidth: true
		}
	});
</script>
<div class="mermaid" align="center" >
	
graph LR
    Snap{Take snapshot}
    GV[Google Vision API]
    LocalDB[Local Cartridge DB]
    RemoteDB[DuckDuckGo Cartridge Search]
    HLTB[How Long To Beat API]
    Result>HLTB Results]

    Snap --> GV
    GV --> LocalDB
    GV --> RemoteDB
    LocalDB --> HLTB
    RemoteDB --> HLTB
    HLTB --> Result

</div>
<p>First, the resized camera picture is uploaded to <a href="https://cloud.google.com/vision/">Google&rsquo;s Vision API</a>. <strong>You will need your own API key</strong> and put it in <code>apikeys.properties</code>, see the README.md file in the repository. Google offers a free trial to its Cloud system.</p>
<p>Next, the Vision API returns OCR-recognized text from the image. We&rsquo;re interested in the so-called <strong>cartridge code</strong> on the left of the cart, which starts with <code>DMG-</code> (Dot Matrix Game) if it&rsquo;s an old school Game Boy cart, or with <code>CGB-</code> (Color Game Boy) if it&rsquo;s a Game Boy Color cart.</p>
<p>For example, the <em>Wario Land: Super Mario Land 3</em> cartridge:</p>
<p><figure>
	<a href="../../img/warioland.jpg" data-featherlight="image">
		<img src="../../img/warioland.jpg"  >
	</a>
	
</figure>
</p>
<p>displays <code>DMG-WJ-USA</code> sideways. This code uniquely identifies the game. Google&rsquo;s Vision API is not smart enough to detect the fancy lettering in the Wario Land logo, sadly.</p>
<p>Next, based on that code, the app searchers for the matching game title, either in a pre-defined repository (an embedded <code>.csv</code> file based on the database of <a href="https://gbhwdb.gekkio.fi/cartridges/">gekkio.fi</a>), or if it was not found, fires off a DuckDuckGo search to try and interpret its results as a game title. Note that there is no real DuckDuckGo API: the app employs HTML scraping.</p>
<p>Lastly, if a game title could be found, it is fed to <a href="https://howlongtobeat.com">howlongtobeat.com</a>&mdash;also using (admittedly a bit advanced) HTML scraping&mdash;to finally return the results in a list for a <code>RecyclerView</code> to display to the user. If at any step something goes wrong, a correct error message is displayed, and the user can retry the whole process.</p>
<p>Selecting a result from the HLTB results list automatically adds that game to your local database. You can &ldquo;finish&rdquo; the game by checking a checkbox in the game detail screen, meaning it took you <code>x</code> hours to finish. The statistics dialog box shows how long you still have to play to finish your entire collection. Good luck have fun!</p>
<h2 id="inspecting-the-source-code">Inspecting the source code</h2>
<p>What to look out for in the source code?</p>
<ul>
<li>Try to understand how the unit tests are written. Again, note the difference between Android-instrumented tests, which run more slowly, and genuine unit tests. The <code>mockk</code> framework is used to mock out certain objects in certain tests (see <a href="../../lang/tdd">test driven development</a>).</li>
<li>Try to identify the information flow as described above. Can you follow its logic and see where one fragment switches to another one? Understanding the general flow of the program is very important!</li>
<li>Note the use of interfaces. In case the Google Vision API does not suffice anymore, or the free trail threshold limit has been reached, it&rsquo;s easy to remove it in favor for another OCR-based API, thanks to the <code>ImageRecognizer</code> interface. Furthermore, it simplifies unit testing and separates the view code from the API logic.</li>
</ul>
<p>Some more advanced concepts of Kotlin/Android, such as <code>suspend</code> and coroutines, which are not part of this course, can be safely ignored. Just remember that when executing IO calls that take longer than a second, it should be done on a <em>separate thread</em>, otherwise the main thread&mdash;and thus, the UI&mdash;becomes blocked! Starting new threads can be done simply by using the Java-specific logic you have learned in the INF1 course. Otherwise, there&rsquo;s always Stack Overflow to help out. Make sure you understand what you adapt into your own project!</p>

<div class="notices warning" ><p>In case the project fails to compile: did you forget to create a properties file with your API key in it? See the readme and above!</p>
</div>

<p>Dependencies used:</p>
<ul>
<li><code>kotlinx</code> serialization (transfer results between fragments)</li>
<li><code>kotlinx</code> coroutines (async job processing)</li>
<li><code>mockk</code> instead of Mockito (mocking in unit tests)</li>
<li><code>androidx.navigation</code> (navigation)</li>
<li><code>androidx.room</code> (DB persistence)</li>
<li><code>android.volley</code> (HTTP calls)</li>
<li><code>google.api-client</code> (Vision API, 3 dependencies)</li>
</ul>
<p>Build features used:</p>
<ul>
<li>Android View binding</li>
<li>Custom build config flags</li>
<li><code>kapt</code> for Room annotation processing</li>
<li><code>serialization</code> for Kotlin-to-Java serialization</li>
</ul>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../extra/project/" title="4. Project Information"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../extra/install/" title="1. Installation Guide" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1646044682"></script>
    <script src="../../js/perfect-scrollbar.min.js?1646044682"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1646044682"></script>
    <script src="../../js/jquery.sticky.js?1646044682"></script>
    <script src="../../js/featherlight.min.js?1646044682"></script>
    <script src="../../js/modernizr.custom-3.6.0.js?1646044682"></script>
    <script src="../../js/learn.js?1646044682"></script>
    <script src="../../js/hugo-learn.js?1646044682"></script>
    
        
            <script src="../../mermaid/mermaid.js?1646044682"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

